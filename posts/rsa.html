<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65924431-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-65924431-1');
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="https://fonts.googleapis.com/css?family=Barlow" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Federico Mora</title>
    <link rel="stylesheet" type="text/css" href="../css/default.css" title="default">
</head>

<body itemscope="" itemtype="http://schema.org/Person">
    <img id="id-picture" itemprop="image" src="../images/me.png" alt="picture" width="80" height="110">
    <h1>
        <span itemprop="name">
            <span class="nobreak" itemprop="givenName">Federico</span>
            <span class="nobreak" itemprop="familyName">Mora</span>
        </span>
    </h1>
    <ul class="topnav">
        <li><a href="../index.html">Overview</a></li>
        <li><a href="../blog.html">Blog</a></li>
        <li><a href="../contact.html">Contact</a></li>
    </ul>

    <br>

<h2>RSA Proof of Correctness</h2>

<p class="subtitle">Oct. 27, 2015</p>

<p>RSA is a public key cipher developed by Ron Rivest, Adi Shamir, and Leonard Adleman in 1977. In this post I will present
    the proof of correctness in the most clear and thorough way I can, drawing theorems, and many proofs, from
    <a href="#[1]">[1]</a> and
    <a href="#[2]">[2]</a>. This post, while heavy mathematically, is almost entirely self contained. I believe anyone with enough patience
    can follow it.</p>

<!--more-->

<h3>Motivation</h3>
<p>Imagine you want to send a file to a distant friend. Using a traditional cipher you will first need to communicate with your
    friend a key which you will use to encrypt the file and they will use to decrypt the file on the other end. This is like
    sending your friend a locked box and key by mail: if the key were to be intercepted by an attacker, then all security
    given by the subsequent encryption would be lost. Public key cryptography allows us to avoid this
    <a href="http://cs.wellesley.edu/~cs310/lectures/public_key_slides_handouts.pdf">key distribution problem</a> through some very clever mathematics.</p>

<p>RSA, our exemplar public key cipher, is easy to use, but a little more difficult to understand. The six steps immediately
    following this paragraph completely describe the RSA cipher. To understand the algorithm we first need to understand
    a few terms. The function \(gcd(x,y)\) returns the greatest common denominator of \(x\) and \(y\). If \(gcd(x,y) = 1\)
    then we say that \(x\) and \(y\) are relatively prime. \(\varphi(n)\) is Euler's totient function which returns the number
    of positive integers less than \(n\) that are relatively prime to \(n\). For a product of two primes like \(n = pq\),
    \(\varphi(n) = (p-1)(q-1)\).</p>

<ol type='I'>
    <li>The receiver chooses secret primes \(p\) and \(q\) and computes \(n = qp\)</li>
    <li>The receiver chooses \(e\) with \(gcd(e, \varphi(n)) = 1\)</li>
    <li>The receiver computes \(d\) with \(de \equiv 1 \mod \varphi(n)\)</li>
    <li>The receiver makes \(n\) and \(e\) public, and keeps \(d\) secret</li>
    <li>The sender encrypts \(m\) as \(c \equiv m^e \mod n\)</li>
    <li>The receiver decrypts by computing \(m \equiv c^d \mod n\)</li>
</ol>

<p>RSA is called a public key cipher because the receiver publicly posts the number pair \((n,e)\) which is used to encrypt
    a message, and then uses the private number \(d\) to decrypt it. Public key ciphers are also sometimes called asymmetric
    key ciphers. Before moving on to the proof of correctness, let's look at an example of the algorithm in use.</p>

<h4>Example</h4>
<p>In this example, the message \(m = 22\) (just a number, but remember, numbers can represent anything) is encrypted and then
    sent to a receiver whose public key is the number pair \((e=11,n=35)\). The receiver uses his/her private key, which
    only he/she knows, \(d=11\), to decrypt the message on the other end. Below is a step by step walk through of the process.</p>

<p>The receiver selects \(p = 7\), \(q = 5\), and so \(n = pq = 35\). In this case \(\varphi(n) = (p-1)(q-1) = (7-1)(5-1) =
    24\) and so we need an \(e\) such that \(gcd(e,\varphi(n) = 24) = 1\). The receiver selects \(e = 11\), since 11 and
    24 are relatively prime and then assigns \(d = 11^{-1} \equiv 11 \mod 24\). The receiver makes \(e = 11\) and \(n = 35\)
    publicly available and waits to receive a message.</p>
<p>The sender encrypts a secret message \(m = 22\) by computing \(c = m^e \mod n\), i.e, \(c = 22^{11} \equiv 8 \mod 35\). The
    secret message, \(c\), is then sent to the receiver who decrypts the message by computing \(m = c^d \mod n\), i.e, \(m
    = 8^{11} \equiv 22 \mod 35\). </p>

<h3>Background</h3>
<p>Now that we have seen how the RSA cipher works, we will turn our attention to the proof of correctness. That is, we want
    to prove that \(\forall \ m \ \in \ \Bbb Z_n\), \((m^e)^d \equiv m \mod n\). This background section will give the reader
    all necessary information to follow the main proof. A reader familiar with group theory may want to skip this section.</p>

<h4>Group Theory</h4>
<p>
    <b>Definition</b>: A
    <b>group</b> \((G, *)\) is a set \(G\) together with a binary operation, \(*\) that satisfies the following axioms.
    <ol>
        <li>The binary operation is
            <u>closed</u>. That is, if \(a,b \in G\) then \(a*b \in G\).</li>
        <li>The binary operation is
            <u>associative</u>. That is, \((a*b)*c = a*(b*c)\) for \(a,b,c \in G\).</li>
        <li>There exists an element \(e \in G\), called the
            <u>identity</u> element, such that for any element \(a \in G\), \(e*a = a*e = a\)</li>
        <li>For each element \(a \in G\), there exists an
            <u>inverse</u> element in G, denoted by \(a^{-1}\) such that \(a*a^{-1} = a^{-1}*a = e\)</li>
    </ol>
</p>
<p>
    <b>Definition</b>: A
    <b>subgroup</b> \(H\) of a group \(G\) is a subset \(H\) of \(G\) such that when the group operation of \(G\) is restricted
    to \(H\), \(H\) is a group in its own right.</p>
<p>
    <b>Lemma 1</b>: Let \(G\) be a group and \(a\) be any element in \(G\). Then the set \(\lt a\gt = \{a^k : k \in \Bbb Z\}\)
    is a subgroup of \(G\).</p>
<p>
    <u>Proof</u>: \(\lt a\gt\) contains the
    <u>identity</u> since \(a^0 = e\). \(\lt a\gt\) is
    <u>closed</u> since if \(g\) and \(h\) are any two elements in \(\lt a\gt\), then by the definition of \(\lt a\gt\) we can
    write \(g = a^m\) and \(h = a^n\) for some integers \(m\) and \(n\), and so \(gh = a^ma^n = a^{m+n}\) is again in \(\lt
    a\gt\). Finally, \(\lt a\gt\) has
    <u>inverses</u> since if \(g = a^n \in \lt a\gt\), then the inverse \(g^{-1} = a^{-n}\) is also in \(\lt a\gt\).</p>
<p>
    <b>Definition</b>: The
    <b>order</b> of \(a\) is the smallest positive integer \(n\) such that \(a^n = e\).</p>
<hr style="width: 100%; color: light-grey; height: 0.7px; background-color:light-grey;" />
<p>
    <a class="anchor" id="Fact"></a>
    <b>Fact</b>: \(U_n\) is the set consisting of all integers less than \(n\) that are relatively prime to \(n\). \(U_n\) has
    \(\varphi(n)\) elements and together with multiplication \(mod \ n\) is a group. </p>
<p>
    <u>Proof</u>: This is the one element of this post I will not justify (I may return to this and add a proof).</p>
<hr style="width: 100%; color: light-grey; height: 0.7px; background-color:light-grey;" />
<p>
    <b>Definition</b>: Let \(G\) be a group and \(H\) a subgroup of \(G\). Define a left
    <b>coset</b> of \(H\) with representative \(g \ \in \ G\) to be the set \(gH = \{gh \ : \ h \ \in \ H\}\). Right cosets
    can be defined similarly.</p>
<p>
    <b>Lemma 2</b>: Let \(H\) be a subgroup of a group \(G\). Then the left cosets of \(H\) in \(G\) partition \(G\). That is,
    the group \(G\) is the disjoint union of the left cosets of \(H\) in \(G\).</p>
<p>
    <u>Proof</u>: Let \(g_1, g_2 \in G\), want to show that either \(g_1H \cap g_2H = \emptyset\) or that \(g_1H = g_2H\). Suppose
    \(g_1H \cap g_2H \neq \emptyset\) and let \(a \in \{g_1H \cap g_2H\}\).
    <ol style="list-style-type:none">
        <li>\(a = g_1h_1 = g_2h_2\) by definition of coset for some elements \(h_1, h_2 \in H\)</li>
        <li>\(g_1 = g_2h_2h_1^{-1}\)</li>
        <li>\(g_1 = g_2h_3\) where \(h_3 = h_2h_1^{-1} \in H\)</li>
        <li> and by similar reasoning \(g_2 = g_1h_4\) where \(h_4 = h_1h_2^{-1} \in H\)</li>
    </ol>
    Now, \(g_1H \subseteq g_2H\) because \(\forall \ h \in H\), \(g_1h = g_2h_3h \in g_2H\), and \(g_2H \subseteq g_1H\) since
    \(\forall \ h \in H\), \(g_2h = g_1h_4h \in g_1H\), so \(g_1H = g_2H\).</p>
<p>So we have shown that if \(g_1H \cap g_2H \neq \emptyset\) then \(g_1H = g_2H\) and we are done.
</p>
<p>
    <b>Definition</b>: Let \(G\) be a group and \(H\) be a subgroup of \(G\). Define the
    <b>index</b> of \(H\) in \(G\) to be the number of distinct left cosets of \(H\) in \(G\). We will denote the index by \([G
    : H]\).</p>
<hr style="width: 100%; color: light-grey; height: 0.7px; background-color:light-grey;" />
<p>
    <b>Lemma 3</b>: Let \(H\) be a subgroup of \(G\) with \(g \ \in \ G\). The number of elements in \(H\) is the same as the
    number of elements in \(gH\).</p>
<p>
    <u>Proof</u>: Define a map \(\phi: \ H \ \rightarrow \ gH\) by \(\phi(h) = gh\). The map \(\phi\) is bijective; hence, the
    number of elements in \(H\) is the same as the number of elements in \(gH\). First we show the \(\phi\) is one-to-one.
    Suppose \(\phi(h_1) = \phi(h_2)\) for some \(h_1, h_2 \in H\).
    <ol style="list-style-type:none">
        <li>\(\phi(h_1) = \phi(h_2)\)</li>
        <li>\(gh_1 = gh_2\)</li>
        <li>\(h_1 = h_2\)</li>
    </ol>
    Therefore \([\phi(h_1) = \phi(h_2)] \Rightarrow [h_1 = h_2]\) and so \(\phi\) is one-to-one. Now we show that \(\phi\) is
    onto, that is, \([\forall \ gh \in gH, \ \exists \ h \in H \ | \ \phi(h) = gh]\). This is trivial since \(\phi(h) = gh\).</p>
<p>\(\phi\) has been shown to be one-to-one and onto and so bijective, and we are done.</p>

<h4>Lagrange's Theorem</h4>
<p>
    <b>Lagrange's Theorem</b>: Let \(G\) be a finite group and let \(H\) be a subgroup of \(G\). Then \(|G|/|H| = |G:H|\) is
    the number of distinct left cosets of \(H\) in \(G\). In particular, the number of elements in \(H\) must divide the
    number of elements in \(G\).</p>

<p>
    <u>Proof</u>: The group \(G\) is partitioned into \(|G:H|\) distinct left cosets (by lemma 2), with each left coset of size
    \(|H|\) (by lemma 3). That is, \(|G|= |G:H||H|\), and so the theorem follows.</p>
<p>
    <b>Corrolary (Lagrange)</b>: Suppose that \(G\) is a finite group and \(g \ \in \ G\). Then the order of \(g\) must divide
    the number of elements in \(G\).</p>
<p>
    <u>Proof</u>: The group generated by \(g\), \(\lt g\gt\) is a subgroup of \(G\) (by Lemma 2) so by Lagrange's theorem we
    know that \(|G|/|\lt g\gt| = |G:\lt g\gt|\) and since \(|G:\lt g\gt|\) is an integer we know that the order of of \(g\)
    divides the order of \(G\).</p>


<h4>Euler's Theorem</h4>
<a class="anchor" id="Euler"></a>
<p>
    <b>Euler's Theorem</b>: Let \(a\) and \(n\) be integers such that \(n > 0\) and \(gcd(a,n) = 1\). Then \(a^{\varphi(n)}
    \equiv 1 \mod n\).</p>
<p>
    <u>Proof</u>: We know that \(a \in U_n\) since \(gcd(a,n) = 1\), that \(U_n\) is a group with order \(\varphi(n)\)(see
    <a
        href="#Fact">fact</a>), and that the set generated by \(a\), \(\lt a\gt\), is a subgroup. By the corollary to Lagrange's theorem we
        see that \(\varphi(n) = |\lt a\gt|k\), for some integer \(k\), and the rest of the proof is algebra.
        <ol style="list-style-type:none">
            <li>\(a^{\varphi(n)}\)</li>
            <li>\(= a^{|\lt a\gt|k}\)</li>
            <li>\(= (a^{|\lt a\gt|})^k\)</li>
            <li>\(\equiv (1)^k \mod n\)</li>
            <li>\(\equiv 1 \mod n\)</li>
        </ol>
</p>

<h4>Fermat's little Theorem</h4>
<a class="anchor" id="Fermat"></a>
<p>
    <b>Fermat's Little Theorem</b>: Let \(p\) be any prime number and suppose that \(p\) does not divide \(a\). Then \(a^{p-1}
    \equiv 1 \mod p\) Furthermore, for any integer \(b\), \(b^p \equiv b \mod p\).</p>
<p>
    <u>Proof</u>: The first part of the proof follows from Euler's theorem since \(\varphi(p) = p-1\). For the second and more
    general part of the theorem, we have two possible cases. If \(gcd(b,p) = 1 \) then this result follows from the first
    part of the theorem. That is
    <ol style="list-style-type:none">
        <li>\(b^{p-1} \equiv 1 \mod p\)</li>
        <li>\(b^{p-1}(b) \equiv 1(b) \mod p\)</li>
        <li>\(b^{p} \equiv b \mod p\)</li>
    </ol>
    In the second case, \(p\) divides \(b\), that is, for some integer \(k\), \(pk = b\) so \(b = 0 \mod p\) and the theorem
    follows since \(0\) to the power of anything (except 0) is \(0\).
</p>



<h3>RSA Proof</h3>
<p>Now we have everything we need to prove the correctness of the RSA cipher. The proof consists of three cases that cover all
    possibilities scenarios. Remember, we want to show that \(\forall \ m \ \in \ \Bbb Z_n\), \((m^e)^d \equiv m \mod n\),
    and so will need to do that for each case assumption.</p>
<h3>Case 1: \(m \equiv 0 \mod n\)</h3>
<p>This is a trivial case, \((0^e)^d \equiv 0 \mod n \)</p>
<h3>Case 2: \(gcd(m,n) = 1\)</h3>
<p>Note that \(ed \equiv 1 \mod \varphi(n)\) so
    <ol style="list-style-type:none">
        <li>\(ed \equiv 1 \mod \varphi(n)\)</li>
        <li>\(ed - 1 = k\varphi(n)\) for some integer \(k\) by definition of modulo operator</li>
        <li>\(ed = k\varphi(n) + 1\)</li>
    </ol>
    Let \(m \ \in \ \Bbb Z_n\)
    <ol style="list-style-type:none">
        <li>\((m^e)^d \mod n\)</li>
        <li>\(\equiv m^{ed} \mod n\)</li>
        <li>\(\equiv m^{k\varphi(n)+1} \mod n\) by Case 2 note</li>
        <li>\(\equiv m^{k\varphi(n)} m \mod n\)</li>
        <li>\(\equiv (m^{\varphi(n)})^k m \mod n\)</li>
        <li>\(\equiv 1^k m \mod n\) by
            <a href="#Euler">Euler's Theorem</a>
        </li>
        <li>\(\equiv m \mod n\)</li>
    </ol>
</p>
<h3>Case 3: \(gcd(m,n) > 1\)</h3>
<p>Note that \(0 \lt m \lt n\) and that the only things that divide \(n\) are \(p\) and \(q\), this, together with the case
    assumption that \(gcd(m,n) > 1\), means that either \(p\) or \(q\) divide \(m\). So, without losing generality, we will
    assume \(gcd(m,n) = p\), which means that \(m = lp\) for some integer \(l\) and that \(gcd(m,q) = 1\), i.e, \(q\) does
    not divide into m. The latter is because if \(m\) was a multiple of both \(p\) and \(q\) then \(m\) would be a multiple
    of \(n\) and we would be in case 0. Furthermore, \(gcd(m^j,q) = 1\) for any \(j > 1\) by the fundamental theorem of arithmetic
    <sup>
        <a href="#f1" id="r1">1</a>
    </sup>. Now for the proof. Let \(m \ \in \ \Bbb Z_n\)
    <ol style="list-style-type:none">
        <li>\((m^e)^d \mod n\)</li>
        <li>\(\equiv m^{ed} \mod n\)</li>
        <li>\(\equiv m^{k\varphi(n)+1} \mod n\) by case 2 note</li>
        <li>\(\equiv m^{k\varphi(n)} m \mod n\)</li>
        <li>\(\equiv m^{k(p-1)(q-1)} m \mod n\)
            <sup>
                <a href="#f2" id="r2">2</a>
            </sup>
        </li>
        <li>\(\equiv m^{j(q-1)} m \mod n\) by letting \(j = k(p-1)\)</li>
    </ol>
    Aside:
    <ol style="list-style-type:none">
        <li>\((m^j)^{(q-1)} \equiv 1 \mod q\) by
            <a href="#Fermat">Fermat's Little Theorem</a> and Case 3 note</li>
        <li>\((m^j)^{(q-1)} - 1 = tq\) for some integer \(t\) by definition of modulo operator</li>
        <li>\((m^j)^{(q-1)} = tq + 1\)</li>
    </ol>
    Back to main proof:
    <ol style="list-style-type:none">
        <li>\(\equiv m^{j(q-1)} m \mod n\) (where we left off)</li>
        <li>\(\equiv (tq+1) m \mod n\) for some integer \(t\) by aside</li>
        <li>\(\equiv tqm + m \mod n\)</li>
        <li>\(\equiv tq(pl) + m \mod n\) by case 2 note, since p divides m</li>
        <li>\(\equiv tnl + m \mod n\) since \(n = pq\)</li>
        <li>\(\equiv 0 + m \mod n\)</li>
        <li>\(\equiv m \mod n\)</li>
    </ol>
    Since our three cases are exhaustive, \(\forall \ m \ \in \ \Bbb Z_n\), \((m^e)^d \equiv m \mod n\), and RSA has been proven
    to be correct.
</p>

<hr style="width: 100%; color: grey; height: 1px; background-color:grey;" />
<p>
    <sup>
        <a href="#r1" id="f1">1</a>
    </sup> The fundamental theorem of arithmetic states that any number can be decomposed into a unique product of primes. Raising
    an integer \(m\) to a power \(j\) does not introduce new primes into the factorization, but instead repeats the primes
    that were already there. In this way, we can see that if \(m\) and \(q\) do not share any prime factors neither will
    \(m^j\) and \(q\).</p>
<p>
    <sup>
        <a href="#r2" id="f2">2</a>
    </sup> For a product of two primes like \(n = pq\), \(\varphi(n) = (p-1)(q-1)\).</p>
<hr style="width: 100%; color: grey; height: 1px; background-color:grey;" />
<h3>References</h3>
<p>
    <a class="anchor" id="[1]"></a>[1] W Trappe and L Washington.
    <i>Introduction to Cryptography with Coding Theory</i>. Pearson, 2006.</p>
<p>
    <a class="anchor" id="[2]"></a>[2] T Judson.
    <i>Abstract Algebra Theory and Applications</i>. Austin State University, 2014.</p>

</body>

</html>